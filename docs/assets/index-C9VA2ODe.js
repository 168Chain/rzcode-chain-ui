import{d as j,e as l,o as y,g as G,w as e,b as t,a as b,c as E,F as H,i as J,r as k,h as q,f as X,t as R,m as D}from"./index-LuPLBb6h.js";import{C as K}from"./index-CZjbtP4g.js";const Q=b("span",{style:{"font-size":"18px",color:"#fab301"}},"区块",-1),Y=b("span",null,"#",-1),Z={class:"rows"},tt=j({__name:"index",props:{block:{}},setup(M){const h={emptyText:"暂无转账记录!"},x=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}];return(r,m)=>{const v=l("a-input-number"),p=l("a-form-item"),i=l("a-table"),B=l("a-textarea"),$=l("a-form"),z=l("a-card");return y(),G(z,{class:"block-card-container"},{title:e(()=>[Q]),default:e(()=>[t($,{labelCol:{span:4},wrapperCol:{span:20},class:"r-form"},{default:e(()=>[t(p,{label:"高度"},{default:e(()=>[t(v,{value:r.block.height,"onUpdate:value":m[0]||(m[0]=d=>r.block.height=d),style:{width:"100%"},min:"1"},{addonBefore:e(()=>[Y]),_:1},8,["value"])]),_:1}),t(p,{label:"随机数"},{default:e(()=>[t(v,{value:r.block.nonce,"onUpdate:value":m[1]||(m[1]=d=>r.block.nonce=d),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),t(p,{label:"TX",class:"tx"},{default:e(()=>[b("div",Z,[t(i,{bordered:"",columns:x,"data-source":r.block.txs,locale:h,size:"small",pagination:!1},null,8,["data-source"])])]),_:1}),t(p,{label:"前指针"},{default:e(()=>[t(B,{row:2,disabled:"",value:r.block.previous,"onUpdate:value":m[2]||(m[2]=d=>r.block.previous=d),style:{"font-size":"12px"}},null,8,["value"])]),_:1}),t(p,{label:"哈希"},{default:e(()=>[t(B,{row:2,disabled:"",value:r.block.hash,"onUpdate:value":m[3]||(m[3]=d=>r.block.hash=d),style:{"font-size":"12px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),et={class:"blockchain-container"},O=j({__name:"index",props:{blocks:{}},setup(M){return(h,x)=>(y(),E("div",et,[(y(!0),E(H,null,J(h.blocks,r=>(y(),G(tt,{key:r.height,block:r,class:"block-card"},null,8,["block"]))),128))]))}}),at=b("span",{class:"title"},"配置",-1),st={class:"rows"},lt=j({__name:"index",setup(M,{expose:h,emit:x}){const r=[{value:"1",label:"4核GPU"},{value:"2",label:"8核GPU"},{value:"3",label:"16核GPU"}],m=k("1"),v=k("2"),p=k("3"),i=q([]),B={emptyText:"暂无转账记录!"},$=()=>{m.value="1",v.value="2",p.value="3"},z=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}],d=k(!1),V=()=>d.value=!0,N=x,I=C=>{let o="";C==="a"&&(o=m.value),C==="b"&&(o=v.value),C==="c"&&(o=p.value),N("fetch-gpu",{machine:C,gpu:o})},f=k({fm:"",to:"",amt:0}),S=()=>{i.push(f.value),N("fetch-tx",i),P(),d.value=!1},A=()=>(d.value=!1,P()),P=()=>{f.value={fm:"",to:"",amt:0}};return h({reset:$}),(C,o)=>{const W=l("a-button"),U=l("a-select"),T=l("a-form-item"),s=l("a-col"),a=l("a-row"),n=l("a-table"),u=l("a-form"),w=l("a-input"),g=l("a-input-number"),c=l("a-modal"),F=l("a-card");return y(),G(F,{class:"pool-cfg-card"},{title:e(()=>[at]),extra:e(()=>[t(W,{plain:"",onClick:V,danger:""},{default:e(()=>[X("转账")]),_:1})]),default:e(()=>[t(u,{ref:"formRef"},{default:e(()=>[t(a,{justify:"space-between"},{default:e(()=>[t(s,{span:7},{default:e(()=>[t(T,{label:"电脑A"},{default:e(()=>[t(U,{value:m.value,"onUpdate:value":o[0]||(o[0]=_=>m.value=_),options:r,onChange:o[1]||(o[1]=()=>I("a"))},null,8,["value"])]),_:1})]),_:1}),t(s,{span:7},{default:e(()=>[t(T,{label:"电脑B"},{default:e(()=>[t(U,{value:v.value,"onUpdate:value":o[2]||(o[2]=_=>v.value=_),options:r,onChange:o[3]||(o[3]=()=>I("b"))},null,8,["value"])]),_:1})]),_:1}),t(s,{span:7},{default:e(()=>[t(T,{label:"电脑C"},{default:e(()=>[t(U,{value:p.value,"onUpdate:value":o[4]||(o[4]=_=>p.value=_),options:r,onChange:o[5]||(o[5]=()=>I("c"))},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(T,{label:"TX",class:"tx"},{default:e(()=>[b("div",st,[t(n,{bordered:"",columns:z,"data-source":i,locale:B,size:"small",pagination:!1},null,8,["data-source"])])]),_:1})]),_:1},512),t(c,{ref:"xModal",open:d.value,"onUpdate:open":o[9]||(o[9]=_=>d.value=_),title:"开始转账","ok-text":"确认","cancel-text":"取消",width:"400px",closeIcon:!0,zIndex:"100",onOk:S,onCancel:A},{default:e(()=>[t(u,{labelCol:{span:5},wrapperCol:{span:19},model:f.value},{default:e(()=>[t(T,{label:"fm",name:"fm",rules:[{required:!0,message:"please input from address!"}]},{default:e(()=>[t(w,{value:f.value.fm,"onUpdate:value":o[6]||(o[6]=_=>f.value.fm=_),placeholder:"please input from address!"},null,8,["value"])]),_:1}),t(T,{label:"to",name:"to",rules:[{required:!0,message:"please input to address!"}]},{default:e(()=>[t(w,{value:f.value.to,"onUpdate:value":o[7]||(o[7]=_=>f.value.to=_),placeholder:"please input to address!"},null,8,["value"])]),_:1}),t(T,{label:"amt",name:"amt",rules:[{required:!0,message:"please input amount!"}]},{default:e(()=>[t(g,{addonAfter:"Bells",value:f.value.amt,"onUpdate:value":o[8]||(o[8]=_=>f.value.amt=_),style:{width:"100%"},min:"0",placeholder:"please input amount!"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])]),_:1})}}}),ot=b("span",{style:{"font-size":"18px",color:"#f14545"}},"电脑",-1),nt={class:"meta"},it=j({__name:"index",props:{items:{}},setup(M){return(h,x)=>{const r=l("a-list-item-meta"),m=l("a-steps"),v=l("a-list-item"),p=l("a-list"),i=l("a-card");return y(),G(i,{class:"workflow-card"},{title:e(()=>[ot]),default:e(()=>[t(p,{class:"list"},{default:e(()=>[(y(!0),E(H,null,J(h.items,(B,$)=>(y(),G(v,{key:$,style:{"min-height":"87px"}},{default:e(()=>[t(r,null,{avatar:e(()=>[b("span",nt,R(B.title),1)]),_:2},1024),(y(),G(m,{items:B.steps,class:"steps",key:$},null,8,["items"]))]),_:2},1024))),128))]),_:1})]),_:1})}}}),ut={class:"diste-container"},ct=b("span",{style:{"font-size":"18px",color:"#f14545"}},"公链",-1),rt=b("span",null,"  ",-1),mt=b("span",{class:"meta"},"电脑A",-1),pt=b("span",{class:"meta"},"电脑B",-1),_t=b("span",{class:"meta"},"电脑C",-1),dt=5e5,wt=j({__name:"index",setup(M){const h=k(!1),x=q([]),r=k("1"),m=k("2"),v=k("3"),p=q([{title:"电脑A",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑B",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑C",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]}]),i=q([{height:1,nonce:49691,txs:[{fm:"Bridge",to:"Martin",amt:168.168}],previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]);let $="0".repeat(4);const z=async()=>{h.value=!0,D.info("模拟挖矿开始运行......"),await d();const s=i.length+1;try{await Promise.all([V(s).then(()=>console.error("挖矿失败.....")),N(s).then(()=>console.error("挖矿失败.....")),I(s).then(()=>console.error("挖矿失败....."))])}catch(a){console.error("挖矿过程中出现未知错误:",a)}finally{h.value=!1,D.success("模拟挖矿结束......")}},d=async()=>{p.forEach(s=>{s.steps=[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]})},V=async s=>{let a=p[0].steps;await f(a);let n=i[i.length-1],u=await S(n,a);u=await A(u,r.value,a),await P(u,s,a)&&await C(a)},N=async s=>{let a=p[1].steps;await f(a);let n=i[i.length-1],u=await S(n,a);u=await A(u,m.value,a),await P(u,s,a)&&await C(a)},I=async s=>{let a=p[2].steps;await f(a);let n=i[i.length-1],u=await S(n,a);u=await A(u,v.value,a),await P(u,s,a)&&await C(a)},f=async s=>{await new Promise(a=>setTimeout(a,2e3)),s[0].status="process",await new Promise(a=>setTimeout(a,2e3)),s[0].status="finish"},S=async(s,a)=>{await new Promise(g=>setTimeout(g,2e3)),a[1].status="process";let{height:n,hash:u}=s,w={height:n+1,nonce:0,txs:x,hash:"",previous:u};return await new Promise(g=>setTimeout(g,2e3)),a[1].status="finish",w},A=async(s,a,n)=>{await new Promise(c=>setTimeout(c,2e3)),n[2].status="process",a==="1"&&await new Promise(c=>setTimeout(c,9e3)),a==="2"&&await new Promise(c=>setTimeout(c,6e3)),a==="3"&&await new Promise(c=>setTimeout(c,3e3));const{height:u,txs:w}=s;let g=w.map(c=>`${c.fm},${c.to},${c.amt}`).join(";");for(let c=0;c<dt;c++){const F=`${u}${c}${g}`,_=K.SHA256(F).toString();if(_.startsWith($))return s.nonce=c,s.hash=_,await new Promise(L=>setTimeout(L,2e3)),n[2].status="finish",s}return null},P=async(s,a,n)=>(n[3].status="process",await new Promise(u=>setTimeout(u,2e3)),i.length===a?(n[3].status="error",!1):(s!==null&&i.push(s),n[3].status="finish",!0)),C=async s=>{await new Promise(a=>setTimeout(a,2e3)),s[4].status="finish"},o=s=>{const{machine:a,gpu:n}=s;a==="a"&&(r.value=n),a==="b"&&(m.value=n),a==="c"&&(v.value=n)},W=s=>{Object.assign(x,{value:s}),console.log("此处的:",x)},U=k(),T=()=>{i.splice(0,i.length,{height:1,nonce:49691,txs:[{fm:"Bridge",to:"Martin",amt:168.168},{fm:"Adam",to:"Wick",amt:1.68},{fm:"Tomas",to:"Tina",amt:8.61},{fm:"Mike",to:"Eric",amt:16.8},{fm:"Still",to:"Worth",amt:.0168}],previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),U.value.reset(),d()};return(s,a)=>{const n=l("a-col"),u=l("a-row"),w=l("a-button"),g=l("a-list-item-meta"),c=l("a-list-item"),F=l("a-list"),_=l("a-card");return y(),E("div",ut,[t(u,{justify:"space-between",style:{"margin-top":"25px"}},{default:e(()=>[t(n,{span:9},{default:e(()=>[t(lt,{class:"x-data",ref_key:"poolCfg",ref:U,onFetchGpu:o,onFetchTx:W},null,512)]),_:1}),t(n,{span:15},{default:e(()=>[t(it,{items:p},null,8,["items"])]),_:1})]),_:1}),t(_,{style:{display:"flex","flex-direction":"column","margin-top":"10px"}},{title:e(()=>[ct]),extra:e(()=>[t(w,{plain:"",onClick:z,loading:h.value,danger:""},{default:e(()=>[X("挖矿")]),_:1},8,["loading"]),rt,t(w,{plain:"",onClick:T},{default:e(()=>[X("重置")]),_:1})]),default:e(()=>[t(F,{class:"list"},{default:e(()=>[t(c,null,{default:e(()=>[t(g,null,{avatar:e(()=>[mt]),_:1}),t(O,{blocks:i,ref:"aBlockChain"},null,8,["blocks"])]),_:1}),t(c,null,{default:e(()=>[t(g,null,{avatar:e(()=>[pt]),_:1}),t(O,{blocks:i,ref:"bBlockChain"},null,8,["blocks"])]),_:1}),t(c,null,{default:e(()=>[t(g,null,{avatar:e(()=>[_t]),_:1}),t(O,{blocks:i,ref:"cBlockChain"},null,8,["blocks"])]),_:1})]),_:1})]),_:1})])}}});export{wt as default};
