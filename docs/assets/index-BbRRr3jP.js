import{d as S,e as l,o as h,g as P,w as e,b as t,a as b,c as V,F as I,i as K,r as v,t as O,h as L,f as W,m as q}from"./index-LYaT0LI5.js";import{C as Q}from"./index-Jy13Qc5V.js";const R=b("span",{style:{"font-size":"18px",color:"#fab301"}},"区块",-1),X=b("span",null,"#",-1),Y=S({__name:"index",props:{block:{}},setup(D){return(u,p)=>{const f=l("a-input-number"),_=l("a-form-item"),w=l("a-textarea"),d=l("a-form"),n=l("a-card");return h(),P(n,{class:"block-card-container"},{title:e(()=>[R]),default:e(()=>[t(d,{labelCol:{span:4},wrapperCol:{span:20},class:"r-form"},{default:e(()=>[t(_,{label:"高度"},{default:e(()=>[t(f,{value:u.block.height,"onUpdate:value":p[0]||(p[0]=m=>u.block.height=m),style:{width:"100%"},min:"1"},{addonBefore:e(()=>[X]),_:1},8,["value"])]),_:1}),t(_,{label:"随机数"},{default:e(()=>[t(f,{value:u.block.nonce,"onUpdate:value":p[1]||(p[1]=m=>u.block.nonce=m),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),t(_,{label:"数据"},{default:e(()=>[t(w,{rows:4,value:u.block.data,"onUpdate:value":p[2]||(p[2]=m=>u.block.data=m)},null,8,["value"])]),_:1}),t(_,{label:"前指针"},{default:e(()=>[t(w,{row:2,disabled:"",value:u.block.previous,"onUpdate:value":p[3]||(p[3]=m=>u.block.previous=m),style:{"font-size":"12px"}},null,8,["value"])]),_:1}),t(_,{label:"哈希"},{default:e(()=>[t(w,{row:2,disabled:"",value:u.block.hash,"onUpdate:value":p[4]||(p[4]=m=>u.block.hash=m),style:{"font-size":"12px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),Z={class:"blockchain-container"},H=S({__name:"index",props:{blocks:{}},setup(D){return(u,p)=>(h(),V("div",Z,[(h(!0),V(I,null,K(u.blocks,f=>(h(),P(Y,{key:f.height,block:f,class:"block-card"},null,8,["block"]))),128))]))}}),tt=b("span",{style:{"font-size":"18px",color:"#f14545"}},"配置",-1),et=S({__name:"index",setup(D,{expose:u,emit:p}){const f=[{value:"1",label:"4核GPU"},{value:"2",label:"8核GPU"},{value:"3",label:"16核GPU"}],_=v("1"),w=v("2"),d=v("3"),n=v(null),m=()=>{n.value=null,_.value="1",w.value="2",d.value="3"},C=p,T=x=>{let o="";x==="a"&&(o=_.value),x==="b"&&(o=w.value),x==="c"&&(o=d.value),C("fetch-gpu",{machine:x,gpu:o})},F=()=>C("fetch-data",n);return u({reset:m}),(x,o)=>{const $=l("a-select"),y=l("a-form-item"),B=l("a-col"),U=l("a-row"),G=l("a-textarea"),z=l("a-form"),j=l("a-card");return h(),P(j,{style:{"min-height":"370px"}},{title:e(()=>[tt]),default:e(()=>[t(z,null,{default:e(()=>[t(U,{justify:"space-between"},{default:e(()=>[t(B,{span:7},{default:e(()=>[t(y,{label:"电脑A"},{default:e(()=>[t($,{value:_.value,"onUpdate:value":o[0]||(o[0]=g=>_.value=g),options:f,onChange:o[1]||(o[1]=()=>T("a"))},null,8,["value"])]),_:1})]),_:1}),t(B,{span:7},{default:e(()=>[t(y,{label:"电脑B"},{default:e(()=>[t($,{value:w.value,"onUpdate:value":o[2]||(o[2]=g=>w.value=g),options:f,onChange:o[3]||(o[3]=()=>T("b"))},null,8,["value"])]),_:1})]),_:1}),t(B,{span:7},{default:e(()=>[t(y,{label:"电脑C"},{default:e(()=>[t($,{value:d.value,"onUpdate:value":o[4]||(o[4]=g=>d.value=g),options:f,onChange:o[5]||(o[5]=()=>T("c"))},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(y,{label:"数据",style:{"margin-top":"10px"}},{default:e(()=>[t(G,{rows:7,value:n.value,"onUpdate:value":o[6]||(o[6]=g=>n.value=g),onChange:F},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),at=b("span",{style:{"font-size":"18px",color:"#f14545"}},"电脑",-1),st={class:"meta"},lt=S({__name:"index",props:{items:{}},setup(D){return(u,p)=>{const f=l("a-list-item-meta"),_=l("a-steps"),w=l("a-list-item"),d=l("a-list"),n=l("a-card");return h(),P(n,{class:"workflow-card"},{title:e(()=>[at]),default:e(()=>[t(d,{class:"list"},{default:e(()=>[(h(!0),V(I,null,K(u.items,(m,C)=>(h(),P(w,{key:C,style:{"min-height":"87px"}},{default:e(()=>[t(f,null,{avatar:e(()=>[b("span",st,O(m.title),1)]),_:2},1024),(h(),P(_,{items:m.steps,class:"steps",key:C},null,8,["items"]))]),_:2},1024))),128))]),_:1})]),_:1})}}}),nt={class:"diste-container"},ot=b("span",{style:{"font-size":"18px",color:"#f14545"}},"公链",-1),it=b("span",null,"  ",-1),ut=b("span",{class:"meta"},"电脑A",-1),ct=b("span",{class:"meta"},"电脑B",-1),rt=b("span",{class:"meta"},"电脑C",-1),pt=5e5,ft=S({__name:"index",setup(D){const u=v(!1),p=v(""),f=v("1"),_=v("2"),w=v("3"),d=L([{title:"电脑A",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑B",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑C",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]}]),n=L([{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]);let C="0".repeat(4);const T=async()=>{u.value=!0,q.info("模拟挖矿开始运行......"),await F();const s=n.length+1;try{await Promise.all([x(s).then(()=>console.error("挖矿失败.....")),o(s).then(()=>console.error("挖矿失败.....")),$(s).then(()=>console.error("挖矿失败....."))])}catch(a){console.error("挖矿过程中出现未知错误:",a)}finally{u.value=!1,q.success("模拟挖矿结束......")}},F=async()=>{d.forEach(s=>{s.steps=[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]})},x=async s=>{let a=d[0].steps;await y(a);let i=n[n.length-1],r=await B(i,a);r=await U(r,f.value,a),await G(r,s,a)&&await z(a)},o=async s=>{let a=d[1].steps;await y(a);let i=n[n.length-1],r=await B(i,a);r=await U(r,_.value,a),await G(r,s,a)&&await z(a)},$=async s=>{let a=d[2].steps;await y(a);let i=n[n.length-1],r=await B(i,a);r=await U(r,w.value,a),await G(r,s,a)&&await z(a)},y=async s=>{await new Promise(a=>setTimeout(a,2e3)),s[0].status="process",await new Promise(a=>setTimeout(a,2e3)),s[0].status="finish"},B=async(s,a)=>{await new Promise(c=>setTimeout(c,2e3)),a[1].status="process";let{height:i,hash:r}=s,k={height:i+1,nonce:0,data:p.value,hash:"",previous:r};return await new Promise(c=>setTimeout(c,2e3)),a[1].status="finish",k},U=async(s,a,i)=>{await new Promise(c=>setTimeout(c,2e3)),i[2].status="process",a==="1"&&await new Promise(c=>setTimeout(c,9e3)),a==="2"&&await new Promise(c=>setTimeout(c,6e3)),a==="3"&&await new Promise(c=>setTimeout(c,3e3));const{height:r,data:k}=s;for(let c=0;c<pt;c++){const A=`${r}${c}${k}`,N=Q.SHA256(A).toString();if(N.startsWith(C))return s.nonce=c,s.hash=N,await new Promise(E=>setTimeout(E,2e3)),i[2].status="finish",s}return null},G=async(s,a,i)=>(i[3].status="process",await new Promise(r=>setTimeout(r,2e3)),n.length===a?(i[3].status="error",!1):(s!==null&&n.push(s),i[3].status="finish",!0)),z=async s=>{await new Promise(a=>setTimeout(a,2e3)),s[4].status="finish"},j=s=>{debugger;const{machine:a,gpu:i}=s;debugger;a==="a"&&(f.value=i),a==="b"&&(_.value=i),a==="c"&&(w.value=i)},g=s=>p.value=s,J=v(),M=()=>{n.splice(0,n.length,{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),J.value.reset(),F()};return(s,a)=>{const i=l("a-col"),r=l("a-row"),k=l("a-button"),c=l("a-list-item-meta"),A=l("a-list-item"),N=l("a-list"),E=l("a-card");return h(),V("div",nt,[t(r,{justify:"space-between",style:{"margin-top":"25px"}},{default:e(()=>[t(i,{span:9},{default:e(()=>[t(et,{class:"x-data",ref_key:"poolCfg",ref:J,onFetchGpu:j,onFetchData:g},null,512)]),_:1}),t(i,{span:15},{default:e(()=>[t(lt,{items:d},null,8,["items"])]),_:1})]),_:1}),t(E,{style:{display:"flex","flex-direction":"column","margin-top":"10px"}},{title:e(()=>[ot]),extra:e(()=>[t(k,{plain:"",onClick:T,loading:u.value,danger:""},{default:e(()=>[W("挖矿")]),_:1},8,["loading"]),it,t(k,{plain:"",onClick:M},{default:e(()=>[W("重置")]),_:1})]),default:e(()=>[t(N,{class:"list"},{default:e(()=>[t(A,null,{default:e(()=>[t(c,null,{avatar:e(()=>[ut]),_:1}),t(H,{blocks:n,ref:"aBlockChain"},null,8,["blocks"])]),_:1}),t(A,null,{default:e(()=>[t(c,null,{avatar:e(()=>[ct]),_:1}),t(H,{blocks:n,ref:"bBlockChain"},null,8,["blocks"])]),_:1}),t(A,null,{default:e(()=>[t(c,null,{avatar:e(()=>[rt]),_:1}),t(H,{blocks:n,ref:"cBlockChain"},null,8,["blocks"])]),_:1})]),_:1})]),_:1})])}}});export{ft as default};
