import{d as w,e as s,o as m,g as $,w as e,a as u,t as U,b as a,r as k,f as C,h as D,c as z,F as N,i as S}from"./index-LYaT0LI5.js";import{C as V}from"./index-Jy13Qc5V.js";const F=u("span",{style:{"font-size":"18px",color:"#fab301"}},"区块 ",-1),T={style:{"font-size":"18px",color:"#f14545"}},A=u("span",null,"#",-1),E=w({__name:"BlockCard",props:{block:{}},setup(B){return(t,o)=>{const n=s("a-input-number"),c=s("a-form-item"),h=s("a-textarea"),d=s("a-input"),v=s("a-form"),f=s("a-card");return m(),$(f,{class:"r-card"},{title:e(()=>[F,u("span",T,U(t.block.height),1)]),default:e(()=>[a(v,{labelCol:{span:3},wrapperCol:{span:21}},{default:e(()=>[a(c,{label:"高度"},{default:e(()=>[a(n,{disabled:"",value:t.block.height,"onUpdate:value":o[0]||(o[0]=l=>t.block.height=l),style:{width:"100%"}},{addonBefore:e(()=>[A]),_:1},8,["value"])]),_:1}),a(c,{label:"随机数"},{default:e(()=>[a(n,{disabled:"",value:t.block.nonce,"onUpdate:value":o[1]||(o[1]=l=>t.block.nonce=l),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),a(c,{label:"数据"},{default:e(()=>[a(h,{disabled:"",rows:6,value:t.block.data,"onUpdate:value":o[2]||(o[2]=l=>t.block.data=l)},null,8,["value"])]),_:1}),a(c,{label:"前指针"},{default:e(()=>[a(d,{disabled:"",value:t.block.previous,"onUpdate:value":o[3]||(o[3]=l=>t.block.previous=l),style:{"font-size":"12px"}},null,8,["value"])]),_:1}),a(c,{label:"哈希"},{default:e(()=>[a(d,{disabled:"",value:t.block.hash,"onUpdate:value":o[4]||(o[4]=l=>t.block.hash=l),style:{"font-size":"12px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),H=u("span",{style:{"font-size":"18px",color:"#f14545"}},"数据",-1),J=w({__name:"XData",setup(B,{expose:t,emit:o}){const n=k(""),c=()=>{n.value="",d()},h=o,d=async()=>h("fetch-data",n.value);return t({reset:c}),(v,f)=>{const l=s("a-button"),g=s("a-textarea"),r=s("a-card");return m(),$(r,{class:"r-card"},{title:e(()=>[H]),extra:e(()=>[u("div",null,[a(l,{onClick:c},{default:e(()=>[C("重置")]),_:1})])]),default:e(()=>[a(g,{rows:8,value:n.value,"onUpdate:value":f[0]||(f[0]=i=>n.value=i),onChange:d,placeholder:"请输入数据!"},null,8,["value"])]),_:1})}}}),L={class:"chain-container"},P=u("span",{style:{"font-size":"18px",color:"#f14545"}},"公链",-1),W=u("span",null,"  ",-1),X={class:"card-box"},j=5e5,I=w({__name:"index",setup(B){const t=k(!1),o=k(),n=D([{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]),c=k("");let d="0".repeat(4);const v=async()=>{t.value=!0,console.log("mine start ......."),await new Promise(p=>setTimeout(p,2e3));const r=n[n.length-1],i=f(r,c.value);i&&(n.push(i),t.value=!1)},f=(r,i)=>{const p=r.height+1,y=r.hash;for(let _=0;_<=j;_++){const x=`${p}${_}${i}`,b=V.SHA256(x).toString();if(b.startsWith(d))return{height:p,nonce:_,data:i,previous:y,hash:b}}return null},l=()=>{n.splice(0,n.length,{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),o.value.reset()},g=r=>c.value=r;return(r,i)=>{const p=s("a-button"),y=s("a-card"),_=s("a-col"),x=s("a-row");return m(),z("div",L,[a(x,{gutter:24},{default:e(()=>[a(_,{span:12,class:"left"},{default:e(()=>[a(y,{style:{display:"flex","flex-direction":"column"}},{title:e(()=>[P]),extra:e(()=>[a(p,{plain:"",onClick:v,loading:t.value,danger:""},{default:e(()=>[C("挖矿")]),_:1},8,["loading"]),W,a(p,{plain:"",onClick:l},{default:e(()=>[C("重置")]),_:1})]),default:e(()=>[u("div",X,[(m(!0),z(N,null,S(n,b=>(m(),$(E,{block:b,key:b.height,class:"block"},null,8,["block"]))),128))])]),_:1})]),_:1}),a(_,{span:8,class:"right"},{default:e(()=>[a(J,{class:"x-data",ref_key:"xData",ref:o,onFetchData:g},null,512)]),_:1})]),_:1})])}}});export{I as default};
